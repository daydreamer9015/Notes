# 온라인 서점 데이터베이스 모델링

## 1. 요구사항 분석 (Requirements Analysis)

### 1.1 시스템 개요
온라인 서점 관리 시스템으로 고객이 도서를 검색, 장바구니에 담기, 리뷰 작성 등의 활동을 할 수 있는 전자 상거래 플랫폼

### 1.2 기능적 요구사항
#### 고객 관리
- 고객은 회원가입을 통해서 계정을 생성할 수 있어야 한다.
- 고객은 로그인 인증을 위한 아이디와 비밀번호를 가져야 한다.
- 고객의 기본 정보(이름, 나이, 직업)를 관리할 수 있어야 한다.
- 고객의 활동 등급과 예약 내역을 추적할 수 있어야 한다.

#### 도서 관리
- 도서의 기본 정보(제목, 저자, 가격, 페이지 수)를 관리할 수 있어야 한다.
- 각 도서는 고유한 식별자를 가져야 한다.
- 도서별로 여러 개의 이미지를 등록할 수 있어야 한다.

#### 리뷰 관리
- 고객은 구매한 도서에 대해 리뷰를 작성할 수 있어야 한다.
- 리뷰는 내용과 평점을 포함해야 한다.
- 리뷰 작성 일시가 기록되어야 한다.
- 한 고객이 여러 도서의 리뷰를 작성할 수 있어야 한다.
- 한 도서는 여러 고객의 리뷰를 받을 수 있어야 한다.

#### 장바구니 관리
- 고객은 구매하고자 하는 도서를 장바구니에 담을 수 있어야 한다.
- 장바구니에는 도서별 수량 정보가 포함되어야 한다.
- 장바구니에 담은 날짜가 기록되어야 한다.
- 한 고객이 여러 도서를 장바구니에 담을 수 있어야 한다.

### 1.3 비기능적 요구사항


## 2. 개념적 모델링 (Conceptual Modeling)

### 2.1 엔티티 (Entity) 정의

#### 주요 엔티티
1. **CUSTOMER (고객)** : 서비스를 이용하는 회원
2. **BOOK (도서)** : 판매되는 도서 정보
3. **REVIEW (리뷰)** : 고객이 작성한 도서 평가
4. **CART (장바구니)** : 구매 예정 도서 목록
5. **BOOKIMAGE (도서 이미지)** : 도서 관련 이미지 정보

### 2.2 관계(Relationship) 정의
| 관계명 | 참여 엔티티 | 관계 유형 | 설명
|---------|--------------------|-----|---------------------------|
| 작성한다 | CUSTOMER -> REVIEW | 1:n | 한 고객이 여러 리뷰 작성 가능 |
| 담는다 | CUSTOMER -> CART | 1:n | 한 고객이 여러 장바구니 항목 보유 가능 |
| 받는다 | BOOK -> REVIEW | 1:n | 한 도서가 여러 리뷰를 받을 수 있음 |
| 담긴다 | BOOK -> CART | 1:n | 한 도서가 여러 장바구니에 담길 수 있음 |
| 보유한다 | BOOK -> BOOKIMAGE | 1:n | 한 도서가 여러 이미지를 가질 수 있음 |

### 2.3 속성 (Attribute) 정의

#### CUSTOMER 속성

#### BOOK 속성

#### REVIEW 속성

#### CART 속성

#### BOOKIMAGE 속성

---
## 3. 논리적 모델링 (Logical Modeling - Relation Model)

### 3.1 정규화 과정
#### 정규화 전 초기 상태 (비정규화)
** 초기 단일 테이블 예시: **
```
주문장부 {
    고객ID, 고객명, 나이, 직업,
    도서ID, 도서명, 저자, 가격,
    구매수량, 구매날짜,
    리뷰내용1, 리뷰날짜1,
    리뷰내용2, 리뷰날짜2,
    이미지경로1, 이미지경로2,
}
```

#### 제1정규형 (1NF) - 원자값 보장
**정의** : 모든 속성이 원자값(더 이상 나눌 수 없는 값)을 가지며, 반복 그룹이 없어야 함
**1NF 적용 후**
```
주문장부 {
    고객ID, 고객명, 나이, 직업,
    도서ID, 도서명, 저자, 가격,
    구매수량, 구매날짜,
    리뷰내용, 리뷰날짜,
    이미지경로
}
```

#### 제2정규형 (2NF) - 부분 함수 종속 제거
**정의** : 기본키 전체에 완전 함수 종속
          복합키의 일부분에만 종속되는 속성을 제거

**함수 종속성 분석**:
```
복합키 : (고객ID, 도서ID, 리뷰날짜)
```

**2NF 적용 후 - 테이블 분리**
```
CUSTOMER {
    고객ID(PK),
    고객명, 나이, 직업      // 고객ID에만 종속
}

BOOK {
    도서ID(PK),
    도서명, 저자, 가격      // 도서ID에만 종속
}

PURCHASE {      // 나중에 CART로 발전
    고객ID(FK),
    도서ID(FK),
    구매수량, 구매날짜  // 복합키 전체에 종속
}

REVIEW {
    리뷰ID(PK),
    고객ID(FK),
    도서ID(FK),
    리뷰내용, 리뷰날짜  // 복합키 전체에 종속
}
```

### 3.2 릴레이션 스키마
```

```

## 4. 테이블 정의서 (Table Definition)

### 4.1 CUSTOMER 테이블

### 4.2 BOOK 테이블

### 4.3 REVIEW 테이블

### 4.4 CART 테이블

### 4.5 BOOKIMAGE 테이블

```
erDiagram
    %% 온라인 서점 데이터베이스 ERD
    

    CUSTOMER {
        bigint id PK "기본키"
        varchar(255) username "사용자명"
        varchar(255) password " 비밀번호"
        varchar(255) customerName "고객명"
        int age "나이"
        varchar(255) occupation "직업"
        varchar(255) rating "등급"
        int reserves "예약수"
    }
    BOOK {
        bigint id PK "기본키"
        varchar(255) title "제목"
        varchar(255) author "저자"
        int price "가격"
        int page "페이지수"
    }
    REVIEW {
        bigint id PK "기본키"
        bigint customer_id FK "고객ID"
        bigint book_id FK "도서ID"
        varchar(255) content "리뷰내용"
        int cost "평가점수"
        datetime(6) createdAt "작성일시"
    }
    CART {
        bigint id PK "기본키"
        bigint customer_id FK "고객ID"
        bigint book_id FK "도서ID"
        int quantity "수량"
        datetime(6) cartDate "담은날짜"
    }

    BOOKIMAGE {
        bigint id PK "기본키"
        bigint book_id FK "도서ID"
        varchar(255) path "이미지경로"
        int type "이미지타입"
    }

    %% 관계 정의
    CUSTOMER ||--o{ REVIEW : "작성한다"
    CUSTOMER ||--o{ CART : "담는다"
    BOOK ||--o{ REVIEW : "받는다"
    BOOK ||--o{ CART : "담는다"
    BOOK ||--o{ BOOKIMAGE : "보유한다"

```